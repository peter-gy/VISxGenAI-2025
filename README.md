# Agentic Visual Reporting <img src="/docs/public/assets/vis-logo-light.svg" align="right" alt="IEEE VIS 25 Logo" width="300"/>

> A composable agentic system for automated visual data reporting, implementing a Human-AI Partnership model for transparent and steerable data analysis.

## Overview

This prototype system demonstrates a multi-agent architecture that strategically externalizes logic from LLMs to deterministic modules, leveraging [Draco](https://github.com/cmudig/draco2) for principled visualization design. The system delivers dual outputs:

- **Interactive [Observable](https://github.com/observablehq/notebook-kit) reports** with [Mosaic](https://github.com/uwdata/mosaic) for reader exploration
- **Executable [Marimo](https://marimo.io/) notebooks** for deep, analyst-facing traceability

For complete details, see our [whitepaper](docs/public/assets/paper.pdf).

## Quick Start

### Prerequisites

- Python 3.11+
- Node.js (for documentation and Observable report building)
- [uv](https://github.com/astral-sh/uv) for Python dependency management

### Environment Setup

**⚠️ Environment variables are required for the system to function.**

Create a `.env` file in the project root with the following variables:

```bash
# LLM API Keys
ANTHROPIC_API_KEY=your_key_here
OPENAI_API_KEY=your_key_here
GEMINI_API_KEY=your_key_here
OPENROUTER_API_KEY=your_key_here
VERTEX_AI_CREDENTIALS=your_credentials_here

# Observability (Langfuse)
LANGFUSE_HOST=your_host_here
LANGFUSE_PUBLIC_KEY=your_public_key_here
LANGFUSE_SECRET_KEY=your_secret_key_here

# Object Storage (S3-compatible)
AWS_ACCESS_KEY_ID=your_access_key_here
AWS_SECRET_ACCESS_KEY=your_secret_key_here
AWS_ENDPOINT_URL=your_endpoint_url_here
AWS_CDN_BASE_URL=your_cdn_base_url_here
AWS_BUCKET=your_bucket_name_here

# Observable Notebook Builder API (https://github.com/peter-gy/observable-notebook-builder)
NB_BUILDER_API_USERNAME=your_username_here
NB_BUILDER_API_PASSWORD=your_password_here
NB_BUILDER_API_BASE_URL=your_hosted_apis_base_url_here
```

### Installation

```bash
# Install Python dependencies
uv sync

# Install Node.js dependencies (for documentation)
pnpm install
```

### Development

For interactive development and agent exploration, use Marimo:

```bash
uv run marimo edit workbench/agents.py --no-token --port 3335 --headless
```

This opens an interactive notebook interface where you can step through each agent in the pipeline and inspect their outputs.

### Generate a Report

```python
from visxgenai.main import generate_report

generate_report(
    dataset_uri="https://raw.githubusercontent.com/your-dataset.csv",
    report_goal="I want an accessible, interesting report on the dataset.",
    report_length="At least 3 and at most 7 insights, balanced across types"
)
```

Alternatively, you can trigger an end-to-end report generation in a dedicated Marimo notebook:

```bash
uv run marimo edit workbench/e2e.py --no-token --port 3335 --headless
```

## Architecture

![System Architecture](docs/public/assets/teaser.svg)

The system consists of 11 specialized agents orchestrated in a multi-stage pipeline:

1. **Data Understanding**: Field Refiner → Dataset Describer → Field Expander → Dataset Profiler
2. **Analysis**: Insight Planner → Dataset Deriver → Dataset Publisher
3. **Visualization**: Dataset Visualizer (powered by Draco)
4. **Reporting**: Report Narrator → Dataset Reporter

Read more in our [whitepaper](docs/public/assets/paper.pdf).

## Project Structure

- `src/visxgenai/` - Main agentic implementation using [DSPy](https://dspy.ai/)
- `workbench/` - Development notebooks and utilities
- `docs/` - Documentation and gallery of generated reports

## Gallery

Explore example reports generated by the system in the [gallery](https://peter-gy.github.io/VISxGenAI-2025/gallery/).
